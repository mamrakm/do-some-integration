<!--suppress ALL -->
<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:spring="http://camel.apache.org/schema/spring" xmlns="http://www.springframework.org/schema/beans"
       xsi:schemaLocation="
          http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
          http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd">

    <bean id="activemq" class="org.apache.camel.component.activemq.ActiveMQComponent">
        <property name="connectionFactory">
            <bean class="org.apache.activemq.ActiveMQConnectionFactory">
                <property name="brokerURL" value="tcp://localhost:61616"/>
            </bean>
        </property>
    </bean>
<!--    <bean id="json-format" class="org.apache.camel.component.jackson.JacksonDataFormat">-->
<!--        <property name="unmarshalType" value="cz.mamrakm.integrationservice.dtos.AccountDTO"/>-->
<!--    </bean>-->

    <!-- embed Camel with routes -->
    <camelContext id="camel-crm" xmlns="http://camel.apache.org/schema/spring">


        <rest id="account-post-request" path="/CRMEvent">
            <post path="/account" consumes="application/json">
                <to uri="direct:postAccount"/>
            </post>
        </rest>
        <route id="account-path-route">
            <from uri="direct:postAccount"/>
            <unmarshal  id="unmarshaller-id">
                <json  unmarshalType="cz.mamrakm.integrationservice.dtos.AccountDTO" library="Jackson"/>
            </unmarshal>
            <log loggingLevel="INFO"
                 message="LOG>>>, ${id}, ${header.CamelHttpMethod}, ${routeId}, ${body}, ${exception}, ${exception.message}"/>
            <process ref="getAccountProcessorBean"/>
            <!--            <to uri="activemq:topic:cri.integration.mediation"/>-->
        </route>
    </camelContext>
</beans>
